#!/bin/sh

# copy via OSC 52

case "$1" in
  -h|--help)
    echo "Usage: $(basename "$0")"
    echo
    echo "Copies stdin to the system clipboard using the OSC 52 escape sequence."
    echo "This is useful for copying text when in a remote SSH session."
    exit 0
    ;;
esac

buf=$( cat )
len=$( printf %s "$buf" | wc -c ) max=74994
test $len -gt $max && echo "$0: input is $(( len - max )) bytes too long" >&2
printf "\033]52;c;$( printf %s "$buf" | head -c $max | base64 | tr -d '\r\n' )\a"
